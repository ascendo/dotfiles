timer_start () { : ${timer=$SECONDS}; }
# TODO: format runtime so 1000s becomes 16m40s
timer_stop  () { RUNTIME=$(($SECONDS - $timer)); unset timer; }

trap 'timer_start' DEBUG
PROMPT_COMMAND='get_exit_status; '$PROMPT_COMMAND' timer_stop;'

get_exit_status () {
    EXIT_STATUS=$?
    if [[ 0 -eq $EXIT_STATUS ]]; then
        EXIT_STATUS_COLOR=${ANSI_BOLD}${ANSI_GREEN}
    else
        EXIT_STATUS_COLOR=${ANSI_BOLD}${ANSI_RED}
    fi
}

PS1='\[${ANSI_RESET}\]'

# Set the terminal title.
PS1=$PS1'\[\e]0;\w\a\]'

PS1=$PS1'\n[\t | ${RUNTIME}s | (${SHLVL}) | %\j | !\!]'
PS1=$PS1'\n\u@\h:\[${ANSI_CYAN}\]\w\[${ANSI_RESET}\]'
PS1=$PS1'\n\[${EXIT_STATUS_COLOR}\]\$\[${ANSI_RESET}\] '
export PS1
